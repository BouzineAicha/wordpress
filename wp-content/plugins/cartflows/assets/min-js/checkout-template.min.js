!function(i){function n(){const o=function(){let o,c;var e={hidden:"visibilitychange",webkitHidden:"webkitvisibilitychange",mozHidden:"mozvisibilitychange",msHidden:"msvisibilitychange"};for(o in e)if(o in document){c=e[o];break}return function(e){return e&&document.addEventListener(c,e),!document[o]}}();o(function(){var e=function(o){const c=document.cookie.split(";");for(let e=0;e<c.length;e++){const t=c[e].split("=");if(o===t[0].trim())return decodeURIComponent(t[1])}return null}(cartflows.active_checkout_cookie);e&&o()&&parseInt(cartflows.current_step)!==parseInt(e)&&(i(".woocommerce-checkout-payment, .woocommerce-checkout-review-order-table").block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),i(document.body).trigger("update_checkout"),i(document).ajaxComplete(function(e,o){if(o.hasOwnProperty("responseJSON")){const c=o.responseJSON.hasOwnProperty("fragments")?o.responseJSON.fragments:null;c&&c.hasOwnProperty("wcf_cart_data")&&i(document.body).trigger("wcf_cart_data_restored",[c.wcf_cart_data])}}))})}function r(){function s(e,o,c,t){""===e||"select"===t&&" "===e?o.hasClass("validate-required")&&c.addClass("field-required"):c.removeClass("field-required")}const e=i("form.woocommerce-checkout"),o=e.find("input, textarea"),c=e.find("select");o.on("blur",function(){const e=i(this),o=e.attr("type"),c=e.closest("p.form-row"),t=e.val();s(t,c,e,o)}),c.on("blur",function(){const e=i(this),o=e.closest("p.form-row"),c=o.find(".select2-container--default"),t=o.find("select").val();s(t,o,c,"select")})}function f(){if("yes"===cartflows.allow_persistence&&!1!==function(){var e="test";try{return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(e){return!1}}()){var e="form.woocommerce-checkout #customer_details";const o={set(){const e=[],o=i("form.woocommerce-checkout #customer_details");localStorage.removeItem("cartflows_checkout_form"),o.find("input[type=text], select, input[type=email], input[type=tel]").each(function(){e.push({name:this.name,value:this.value})}),cartflows_checkout_form=JSON.stringify(e),localStorage.setItem("cartflows_checkout_form",cartflows_checkout_form)},get(){if(null!==localStorage.getItem("cartflows_checkout_form")){checkout_data=JSON.parse(localStorage.getItem("cartflows_checkout_form"));for(let e=0;e<checkout_data.length;e++)i("form.woocommerce-checkout [name="+checkout_data[e].name+"]").hasClass("select2-hidden-accessible")?i("form.woocommerce-checkout [name="+checkout_data[e].name+"]").selectWoo("val",[checkout_data[e].value]):i("form.woocommerce-checkout [name="+checkout_data[e].name+"]").val(checkout_data[e].value)}}};o.get(),i(e+" input, "+e+" select").on("change",function(){o.set()})}}function d(){function s(e){const o=e.closest(".form-row"),c=e.is("select")||e.hasClass("select2-hidden-accessible"),t=c?e.find(":selected").text():e.val();""===t?o.removeClass("wcf-anim-label"):o.addClass("wcf-anim-label")}const e=i(".wcf-field-modern-label .woocommerce input, .wcf-field-modern-label .woocommerce select, .wcf-field-modern-label .woocommerce textarea");e.on("focusout input",function(){var e=i(this);s(e)}),i(e).each(function(){var o=i(this);s(o);{const c=o.closest(".form-row"),t=c.hasClass("validate-required");let e=o.attr("placeholder");return t&&""!==e&&(e+=" *"),void o.attr("placeholder",e)}})}const m={init(){i(document.body).on("click",".wcf-submit-coupon",this.submit_coupon),i(document.body).on("click",".wcf-remove-coupon",this.remove_coupon)},submit_coupon(e){e.preventDefault();const c=i(".wcf-custom-coupon-field"),o=i(this).closest(c),t=o.find(".wcf-coupon-code-input"),s=t.val();if(""===s)return t.addClass("field-required"),!1;t.removeClass("field-required");e={coupon_code:s,action:"wcf_woo_apply_coupon",security:cartflows.wcf_validate_coupon_nonce};i.ajax({type:"POST",url:cartflows.ajax_url,data:e,success(e){const o=i(".wcf-custom-coupon-field");o.find(".woocommerce-error, .woocommerce-message").remove();e=JSON.parse(e);!0===e.status?(i(document.body).trigger("update_checkout",{update_shipping_method:!1}),o.prepend(e.msg),c.addClass("wcf-coupon-applied")):(o.prepend(e.msg),c.removeClass("wcf-coupon-applied"))}})},remove_coupon(e){e.preventDefault();e={coupon_code:i(this).attr("data-coupon"),action:"wcf_woo_remove_coupon",security:cartflows.wcf_validate_remove_coupon_nonce};i.ajax({type:"POST",url:cartflows.ajax_url,data:e,success(e){const o=i(".wcf-custom-coupon-field");o.find(".woocommerce-error, .woocommerce-message").hide(),i(".wcf-custom-coupon-field").removeClass("wcf-coupon-applied"),e&&(i(document.body).trigger("update_checkout",{update_shipping_method:!1}),o.prepend(e))}})}};let l=0,u;function w(){const e=i(".wcf-customer-info #billing_email").val();if(void 0!==e&&!cartflows.is_logged_in){if(""!==e){const c=i("#billing_email"),t=i(".wcf-email-validation-block"),s=i(".wcf-customer-login-section");if(t.remove(),o=e,!/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(o))return c.after('<span class="wcf-email-validation-block error">'+cartflows.email_validation_msgs.error_msg+"</span>"),s.removeClass("wcf-show");clearTimeout(u);const a=++l;u=setTimeout(function(){i.ajax({url:cartflows.ajax_url,type:"POST",data:{action:"wcf_check_email_exists",email_address:e,security:cartflows.check_email_exist_nonce},success(e){a===l&&(t.remove(),e.data.success&&s.hasClass("wcf-show")?c.after('<span class="wcf-email-validation-block success">'+cartflows.email_validation_msgs.success_msg+"</span>"):e.data.success?(e.data.is_login_allowed&&(c.after('<span class="wcf-email-validation-block success">'+cartflows.email_validation_msgs.success_msg+"</span>"),s.slideDown(400).addClass("wcf-show")),i(".wcf-create-account-section").hide(),i(".woocommerce-billing-fields__customer-login-label").show()):(s.slideUp(400).removeClass("wcf-show"),i(".wcf-create-account-section .create-account label.checkbox").show(),i(".wcf-create-account-section").show(),i(".woocommerce-billing-fields__customer-login-label").hide()))}})},300)}else i(".wcf-create-account-section").hide(),i(".wcf-customer-login-section").hide(),i(".wcf-email-validation-block").hide(),i(".woocommerce-billing-fields__customer-login-label").show();var o}}i(function(){function l(e,o,c,t){e&&t.removeClass("mt20"),(""!==o||" "!==o&&"select"===c)&&t.addClass("wcf-anim-label"),"hidden"===c&&(t.removeClass("wcf-anim-label"),t.addClass("wcf-anim-label-fix"))}f(),n(),r(),i(document.body).on("click","#wcf-embed-checkout-form .wcf-remove-product",function(e){e.preventDefault();const o=i(this).attr("data-id");e={p_key:i(this).attr("data-item-key"),p_id:o,action:"wcf_woo_remove_cart_product",security:cartflows.wcf_validate_remove_cart_product_nonce};i.ajax({type:"POST",url:cartflows.ajax_url,data:e,success(e){e=JSON.parse(e);!1===e.need_shipping&&i("#wcf-embed-checkout-form").find("#ship-to-different-address-checkbox").attr("checked",!1),i("#wcf-embed-checkout-form").find(".woocommerce-notices-wrapper").first().html(e.msg),i(document).trigger("cartflows_remove_product",[o]),i("#wcf-embed-checkout-form").trigger("update_checkout")}})}),m.init(),o=i(".wcf-field-style-one form.woocommerce-checkout").find("input"),i(o).each(function(){const e=i(this),o=e.attr("type"),c=e.closest(".form-row"),t=c.hasClass("mt20");let s=e.val();e.attr("placeholder","");var a=e.attr("placeholder")?e.attr("placeholder"):"";l(t,s=""===s&&""!==a?a:s,o,c)}),o=i(".wcf-field-style-one form.woocommerce-checkout").find("select"),i(o).each(function(){const e=i(this),o=e.closest(".form-row"),c=o.hasClass("mt20"),t=e.val();l(c,t,"select",o)});{const e=i(".wcf-field-style-one form.woocommerce-checkout, .wcf-field-style-one form.woocommerce-form-login").find("input"),c=i(".wcf-field-style-one form.woocommerce-checkout").find(".select2"),t=i(".wcf-field-style-one form.woocommerce-checkout").find("textarea");e.on("focus",function(){const e=i(this),o=e.closest(".form-row");has_class=o.hasClass("wcf-anim-label"),""===(field_value=e.val())&&o.addClass("wcf-anim-label")}),e.on("focusout",function(){const e=i(this),o=e.closest(".form-row"),c=e.val(),t=e.attr("placeholder")?e.attr("placeholder"):"";""===c&&""===t?o.removeClass("wcf-anim-label"):o.addClass("wcf-anim-label")}),c.on("click",function(){const e=i(this),o=e.closest(".form-row");has_class=o.hasClass("wcf-anim-label"),""===(field_value=e.find(".select2-selection__rendered").text())&&o.addClass("wcf-anim-label")}),c.on("focusout",function(){const e=i(this),o=e.closest(".form-row");has_class=o.hasClass("wcf-anim-label"),""===(field_value=e.find(".select2-selection__rendered").text())?o.removeClass("wcf-anim-label"):o.addClass("wcf-anim-label")}),t.on("click",function(){const e=i(this),o=e.closest(".form-row");has_class=o.hasClass("wcf-anim-label"),""===(field_value=e.val())&&o.addClass("wcf-anim-label")}),t.on("focusout",function(){const e=i(this),o=e.closest(".form-row");has_class=o.hasClass("wcf-anim-label"),""===(field_value=e.val())?o.removeClass("wcf-anim-label"):o.addClass("wcf-anim-label")})}jQuery.each(cartflows_checkout_optimized_fields,function(o,e){e.is_optimized&&(jQuery("#"+o).prepend('<a href="#" id="wcf_optimized_'+o+'">'+e.field_label+"</a>"),jQuery("#wcf_optimized_"+o).on("click",function(e){e.preventDefault(),jQuery("#"+o).removeClass("wcf-hide-field");e=o.replace(/_field/g,"");i("#"+e).trigger("focus"),jQuery(this).remove()}))}),d(),i(".wcf-customer-info #billing_email").on("input",function(){w()}),0<i(".wcf-customer-info #billing_email").length&&w(),i(".wcf-customer-login-url").on("click",function(){const e=i(".wcf-customer-login-section");e.hasClass("wcf-show")?(e.slideUp(400),e.removeClass("wcf-show")):(e.slideDown(400),e.addClass("wcf-show"))}),i(".wcf-customer-login-section__login-button").on("click",function(){var e=i("#billing_email").val(),o=i("#billing_password").val();i.ajax({url:cartflows.ajax_url,type:"POST",data:{action:"wcf_woocommerce_login",email:e,password:o,security:cartflows.woocommerce_login_nonce},success(e){e.data.success?location.reload():i(".wcf-customer-info__notice").addClass("wcf-notice").html(e.data.error)}})});{const s=i(".wcf_cartflows_review_order_wrapper"),a=i(".wcf-order-wrap");let e=!1;var o="onorientationchange"in window?"orientationchange":"resize";return i(".wcf-order-review-toggle").on("click",function(e){e.preventDefault(),s.hasClass("wcf-show")?(s.slideUp(400),s.removeClass("wcf-show"),i(this).removeClass("wcf-show"),i(".wcf-order-review-toggle-text").text(cartflows.order_review_toggle_texts.toggle_show_text)):(s.slideDown(400),s.addClass("wcf-show"),i(this).addClass("wcf-show"),i(".wcf-order-review-toggle-text").text(cartflows.order_review_toggle_texts.toggle_hide_text))}),i(window).on(o,function(){clearTimeout(e),e=setTimeout(function(){769<=(window.innerWidth||i(window).width())&&(s.css({display:"none"}),s.removeClass("wcf-show"),i(".wcf-order-review-toggle").removeClass("wcf-show"),i(".wcf-order-review-toggle-text").text(cartflows.order_review_toggle_texts.toggle_show_text))},200)}),void s.on("change",'select.shipping_method, input[name^="shipping_method"]',function(){a.find('input[name^="shipping_method"][type="radio"]:checked').each(function(){i(this).removeAttr("checked")}),i(document.body).trigger("update_checkout",{update_shipping_method:!0})})}})}(jQuery);